<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Carlos Buenosvinos  | Fixing commit TYPOs in git history with filter-branch</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.58.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.d98f2eb6bcd1eaedb7edf166bd16af26.css" rel="stylesheet">
    

    

    
      
    

    
    
    <meta property="og:title" content="Fixing commit TYPOs in git history with filter-branch" />
<meta property="og:description" content="Last week, we tried at Atrapalo to migrate from our own git repository to Github. That should be easy, is just a matter of three commands already explained in Github&#8217;s guide. The main problem appears when you have some sort of issue with your commits, so messages like &#8220;invalid author email&#8221; raises when trying to push your changes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://carlosbuenosvinos.github.io/fixing-commit-typos-in-git-history-with-filter-branch/" />
<meta property="article:published_time" content="2014-05-12T13:21:12+00:00" />
<meta property="article:modified_time" content="2014-05-12T13:21:12+00:00" />
<meta itemprop="name" content="Fixing commit TYPOs in git history with filter-branch">
<meta itemprop="description" content="Last week, we tried at Atrapalo to migrate from our own git repository to Github. That should be easy, is just a matter of three commands already explained in Github&#8217;s guide. The main problem appears when you have some sort of issue with your commits, so messages like &#8220;invalid author email&#8221; raises when trying to push your changes.">


<meta itemprop="datePublished" content="2014-05-12T13:21:12&#43;00:00" />
<meta itemprop="dateModified" content="2014-05-12T13:21:12&#43;00:00" />
<meta itemprop="wordCount" content="317">



<meta itemprop="keywords" content="filter-branch,git,github,rewriting history,typo commits," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Fixing commit TYPOs in git history with filter-branch"/>
<meta name="twitter:description" content="Last week, we tried at Atrapalo to migrate from our own git repository to Github. That should be easy, is just a matter of three commands already explained in Github&#8217;s guide. The main problem appears when you have some sort of issue with your commits, so messages like &#8220;invalid author email&#8221; raises when trying to push your changes."/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://carlosbuenosvinos.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      Carlos Buenosvinos
    </a>
    <div class="flex-l items-center">
      

      
      











    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        POSTS
      </p>
      <h1 class="f1 athelas mb1">Fixing commit TYPOs in git history with filter-branch</h1>
      
      <p class="tracked">
         By <strong>Carlos Buenosvinos</strong>
      </p>
      
      
      <time class="f6 mv4 dib tracked" datetime="2014-05-12T13:21:12Z">May 12, 2014</time>
      
      
    </header>

    <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>Last week, we tried at Atrapalo to migrate from our own git repository to Github. That should be easy, is just a matter of three commands already explained in <a href="https://help.github.com/articles/importing-an-external-git-repository" target="_blank">Github&#8217;s guide</a>. The main problem appears when you have some sort of issue with your commits, so messages like &#8220;invalid author email&#8221; raises when trying to push your changes.</p>

<p>For checking if your repository is ok, you can run <strong>git fsck</strong>. If everything is ok, nice, however, in our case, some error messages where there.</p>

<p><a href="https://i1.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.11.10.png"><img class="size-large wp-image-418 aligncenter" src="https://i2.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.11.10-1024x344.png?resize=620%2C208" alt="Screen Shot 2014-05-12 at 15.11.10" width="620" height="208" srcset="https://i1.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.11.10.png?resize=1024%2C344&ssl=1 1024w, https://i1.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.11.10.png?resize=300%2C100&ssl=1 300w, https://i1.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.11.10.png?w=1240&ssl=1 1240w" sizes="(max-width: 620px) 100vw, 620px" data-recalc-dims="1" /></a></p>

<p>Let&#8217;s check those commits with issues with <strong>git log bca5308fa04b1d43e47de77fc264a770ba9d2522</strong></p>

<p><a href="https://i1.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.13.48.png"><img class="size-large wp-image-419 aligncenter" src="https://i0.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.13.48-1024x377.png?resize=620%2C228" alt="Screen Shot 2014-05-12 at 15.13.48" width="620" height="228" srcset="https://i1.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.13.48.png?resize=1024%2C377&ssl=1 1024w, https://i1.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.13.48.png?resize=300%2C110&ssl=1 300w, https://i1.wp.com/carlosbuenosvinos.com/posts/images/2014/05/Screen-Shot-2014-05-12-at-15.13.48.png?w=1240&ssl=1 1240w" sizes="(max-width: 620px) 100vw, 620px" data-recalc-dims="1" /></a></p>

<p>Look at the author. There is an additional &#8220;<strong>&lt;</strong>&#8221; that should not be there. That&#8217;s causing the problem. So we need to rewrite the history to update those commits. There are <a href="http://git-scm.com/book/en/Git-Tools-Rewriting-History" target="_blank">different options</a>, but the ones that avoid remerging are based on <strong>filter-branch</strong> but cloning again your repo is a must. If you look to StackOverflow or Google, most of the scripts that are suppose to work are like:</p>

<pre class="brush: bash; gutter: true">$ git filter-branch --commit-filter &#039;
        if [ "$GIT_AUTHOR_EMAIL" = "schacon@localhost" ];
        then
                GIT_AUTHOR_NAME="Scott Chacon";
                GIT_AUTHOR_EMAIL="schacon@example.com";
                git commit-tree "$@";
        else
                git commit-tree "$@";
        fi&#039; HEAD</pre>

<p>But it didn&#8217;t work for us. So after talking with the GitHub guys, here&#8217;s the solution that worked like a charm.</p>

<pre class="brush: bash; gutter: true">git filter-branch -f -- --all</pre>

<p>If take a closer look to git-filter-branch there is an interesting comment in the description:</p>

<blockquote>
<p><span style="color: #4e443c;">If you specify no filters, the commits will be recommitted without any changes, which would normally have no effect. Nevertheless, this may be useful in the future for compensating for some Git bugs or such, therefore such a usage is permitted</span></p>
</blockquote>

<p>The old commits will still be there, but pushing will push just the new ones. If you&#8217;re migrating and try to <strong>push &#8211;mirror</strong>, everything is pushed so it won&#8217;t work due to this old commits. An alternative could be <strong>git push &#8211;all -u origin</strong></p>

<p>Hope it helps somebody.</p><ul class="pa0">
  
   <li class="list">
     <a href="/tags/filter-branch" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">filter-branch</a>
   </li>
  
   <li class="list">
     <a href="/tags/git" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">git</a>
   </li>
  
   <li class="list">
     <a href="/tags/github" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">github</a>
   </li>
  
   <li class="list">
     <a href="/tags/rewriting-history" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">rewriting history</a>
   </li>
  
   <li class="list">
     <a href="/tags/typo-commits" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">typo commits</a>
   </li>
  
</ul>
<div class="mt6">
      
      
      </div>
    </section>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/desarrollo-php-profesional/">Guía para el desarrollo PHP Profesional</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://carlosbuenosvinos.github.io/" >
    &copy; 2019 Carlos Buenosvinos
  </a>
    <div>










</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
