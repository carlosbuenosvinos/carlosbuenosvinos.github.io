<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Carlos Buenosvinos  | Accessing securely production services with SSH port forwarding</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.58.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.d98f2eb6bcd1eaedb7edf166bd16af26.css" rel="stylesheet">
    

    

    
      
    

    
    
    <meta property="og:title" content="Accessing securely production services with SSH port forwarding" />
<meta property="og:description" content="We&#8217;ve already talked about how to deploy your public SSH keys into your server using Ansible and GitHub. This time, I just want to share a simple approach to have access to your production services (MySQL, Elastic, RabbitMQ, etc.) without exposing publicly your services. You have different alternatives, probably the most common are using a VPN or use SSH port forwarding. Let&#8217;s see an example of the last one." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://carlosbuenosvinos.com/accessing-securely-production-services-with-ssh-port-forwarding/" />
<meta property="article:published_time" content="2016-10-25T08:01:46+00:00" />
<meta property="article:modified_time" content="2016-10-25T08:01:46+00:00" />
<meta itemprop="name" content="Accessing securely production services with SSH port forwarding">
<meta itemprop="description" content="We&#8217;ve already talked about how to deploy your public SSH keys into your server using Ansible and GitHub. This time, I just want to share a simple approach to have access to your production services (MySQL, Elastic, RabbitMQ, etc.) without exposing publicly your services. You have different alternatives, probably the most common are using a VPN or use SSH port forwarding. Let&#8217;s see an example of the last one.">


<meta itemprop="datePublished" content="2016-10-25T08:01:46&#43;00:00" />
<meta itemprop="dateModified" content="2016-10-25T08:01:46&#43;00:00" />
<meta itemprop="wordCount" content="550">



<meta itemprop="keywords" content="elastic,mysql,port forwarding,production,rabbitmq,security,ssh," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Accessing securely production services with SSH port forwarding"/>
<meta name="twitter:description" content="We&#8217;ve already talked about how to deploy your public SSH keys into your server using Ansible and GitHub. This time, I just want to share a simple approach to have access to your production services (MySQL, Elastic, RabbitMQ, etc.) without exposing publicly your services. You have different alternatives, probably the most common are using a VPN or use SSH port forwarding. Let&#8217;s see an example of the last one."/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  
  <header class="cover bg-top" style="background-image: url('https://carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-25-at-09.31.35.png');">
    <div class="pb3-m pb6-l bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://carlosbuenosvinos.com/" class="f3 fw2 hover-white no-underline white-90 dib">
      Carlos Buenosvinos
    </a>
    <div class="flex-l items-center">
      

      
      











    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Accessing securely production services with SSH port forwarding</h1>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        POSTS
      </p>
      <h1 class="f1 athelas mb1">Accessing securely production services with SSH port forwarding</h1>
      
      <p class="tracked">
         By <strong>Carlos Buenosvinos</strong>
      </p>
      
      
      <time class="f6 mv4 dib tracked" datetime="2016-10-25T08:01:46Z">October 25, 2016</time>
      
      
    </header>

    <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>We&#8217;ve already talked about <a href="https://carlosbuenosvinos.com/github-ansible-deploy-your-public-ssh-keys-to-your-server/" target="_blank">how to deploy your public SSH keys into your server using Ansible and GitHub</a>. This time, I just want to share a simple approach to have access to your production services (MySQL, Elastic, RabbitMQ, etc.) without exposing publicly your services. You have different alternatives, probably the most common are using a VPN or use SSH port forwarding. Let&#8217;s see an example of the last one.</p>

<p>Consider that you have you cool side project running in Production. You are using some services such as MySQL, RabbitMQ and ElasticSearch. For debugging and having real data, you want to run some queries against MySQL, perform some queries to Elastic or spy some messages in RabbitMQ.</p>

<p>For accessing this production services from your development machine there are different options.</p>

<p><strong>A. Open the ports publicly</strong></p>

<p>This is not recommended because of the security risks. Anyone can just access your ElasticSearch and do whatever they want.</p>

<p><strong>B. Run the services in different ports and make them publicly</strong></p>

<p>Stop, please stop. I&#8217;m serious.</p>

<p><strong>C. Set up a VPN and use it to connect</strong></p>

<p>Now we&#8217;re talking. However, setting a VPN is a bit too much for me. If you&#8217;re interested, take a look to <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-ubuntu-16-04">&#8220;How To Set Up an OpenVPN Server on Ubuntu 16.04&#8221;</a>. The tutorial has lots of steps.</p>

<p><strong>D. Use SSH port forwarding</strong></p>

<p>The basic idea is to forward some of your local ports to a remote IP and ports using SSH. Imagine that you want to access your remote ElasticSearch that runs on port 9200. Let&#8217;s take a closer look to this option.</p>

<p><strong>Let&#8217;s run the some commands!</strong></p>

<p>If you make a curl to <a href="http://my-server.com:9200">http://my-server.com:9200</a> an error page should be shown.</p>

<pre>curl http://my-server.com:9200</pre>

<p><a href="https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.31.38.png?ssl=1"><img class="alignnone size-large wp-image-994" src="https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.31.38.png?resize=620%2C260&#038;ssl=1" alt="screen-shot-2016-10-24-at-22-31-38" width="620" height="260" srcset="https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.31.38.png?resize=1024%2C429&ssl=1 1024w, https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.31.38.png?resize=300%2C126&ssl=1 300w, https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.31.38.png?resize=768%2C322&ssl=1 768w, https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.31.38.png?w=1476&ssl=1 1476w, https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.31.38.png?w=1240&ssl=1 1240w" sizes="(max-width: 620px) 100vw, 620px" data-recalc-dims="1" /></a></p>

<p>And you should see the same if you are not running ElasticSearch in you local machine:</p>

<pre>curl http://localhost:9200</pre>

<p><img class="alignnone size-large wp-image-993" src="https://i1.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.36.png?resize=620%2C291&#038;ssl=1" alt="screen-shot-2016-10-24-at-22-34-36" width="620" height="291" srcset="https://i1.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.36.png?resize=1024%2C481&ssl=1 1024w, https://i1.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.36.png?resize=300%2C141&ssl=1 300w, https://i1.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.36.png?resize=768%2C361&ssl=1 768w, https://i1.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.36.png?w=1476&ssl=1 1476w, https://i1.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.36.png?w=1240&ssl=1 1240w" sizes="(max-width: 620px) 100vw, 620px" data-recalc-dims="1" /></p>

<p>Now, open a new tab and try:</p>

<pre>ssh -L 9200:localhost:9200 root@my-server.com</pre>

<p>First of all, it looks like a ssh command. Cool. If you don&#8217;t have your SSH public key deployed in your server, the command will ask for the root password, as you are used to. After entering the password, you will have access to your remote server. What&#8217;s the difference? What about if we try the curl command again?</p>

<pre>curl http://localhost:9200</pre>

<p><a href="https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.15.png?ssl=1"><img class="alignnone size-large wp-image-995" src="https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.15.png?resize=620%2C349&#038;ssl=1" alt="screen-shot-2016-10-24-at-22-34-15" width="620" height="349" srcset="https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.15.png?resize=1024%2C576&ssl=1 1024w, https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.15.png?resize=300%2C169&ssl=1 300w, https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.15.png?resize=768%2C432&ssl=1 768w, https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.15.png?w=1476&ssl=1 1476w, https://i2.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-24-at-22.34.15.png?w=1240&ssl=1 1240w" sizes="(max-width: 620px) 100vw, 620px" data-recalc-dims="1" /></a></p>

<p>Bam! Our ElasticSearch on Production. <strong>What about if we want to include other services such as MySQL or RabbitMQ?</strong></p>

<pre>ssh -L 9200:localhost:9200 -L 3306:localhost:3306 -L 15672:localhost:15672 root@my-server.com</pre>

<p>The -L options maps local ports with remote ports. In the example, we are mapping our localhost:9200 to my-server.com:9200 (ElasticSearch). The same happens with MySQL (3306) and RabbitMQ Admin Plugin (15672).</p>

<p><strong>What about if you don&#8217;t need to get access to the server, just do the forwarding?</strong></p>

<pre>ssh -nNT -L 9200:localhost:9200 -L 3306:localhost:3306 -L 15672:localhost:15672 root@my-server.com</pre>

<p>The -nNT flags makes the command to wait until Control+C. If you don&#8217;t use it, the command still works but you will get prompt in the remote server.</p>

<p><strong>What about if you&#8217;re running already ElasticSearch on your local machine and you want to map to another port? </strong>No problem.</p>

<pre>ssh -nNT -L 9990:localhost:9200 -L 9991:localhost:3306 -L 9992:localhost:15672 root@my-server.com</pre>

<p><a href="https://i0.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-25-at-09.31.35.png?ssl=1"><img class="alignnone size-large wp-image-1001" src="https://i0.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-25-at-09.31.35.png?resize=620%2C274&#038;ssl=1" alt="screen-shot-2016-10-25-at-09-31-35" width="620" height="274" srcset="https://i0.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-25-at-09.31.35.png?resize=1024%2C452&ssl=1 1024w, https://i0.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-25-at-09.31.35.png?resize=300%2C133&ssl=1 300w, https://i0.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-25-at-09.31.35.png?resize=768%2C339&ssl=1 768w, https://i0.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-25-at-09.31.35.png?w=1476&ssl=1 1476w, https://i0.wp.com/carlosbuenosvinos.com/posts/images/2016/10/Screen-Shot-2016-10-25-at-09.31.35.png?w=1240&ssl=1 1240w" sizes="(max-width: 620px) 100vw, 620px" data-recalc-dims="1" /></a></p>

<p>Hope it helps!</p>

<p>If you want to know more about what you can do with SSH, take a look to this video &#8220;The Black Magic of SSH / SSH Can Do That?&#8221; by Bo Jeanes ;)</p>

<div class="embed-vimeo" style="text-align: center;">
</div><ul class="pa0">
  
   <li class="list">
     <a href="/tags/elastic" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">elastic</a>
   </li>
  
   <li class="list">
     <a href="/tags/mysql" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">mysql</a>
   </li>
  
   <li class="list">
     <a href="/tags/port-forwarding" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">port forwarding</a>
   </li>
  
   <li class="list">
     <a href="/tags/production" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">production</a>
   </li>
  
   <li class="list">
     <a href="/tags/rabbitmq" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">rabbitmq</a>
   </li>
  
   <li class="list">
     <a href="/tags/security" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">security</a>
   </li>
  
   <li class="list">
     <a href="/tags/ssh" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">ssh</a>
   </li>
  
</ul>
<div class="mt6">
      
      
      </div>
    </section>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/domain-driven-design-in-php-book-is-finished/">“Domain-Driven Design in PHP” (@dddbook) is finished</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/guia-para-el-desarrollo-profesional-php-edicion-2014/">Guía para el Desarrollo Profesional PHP (edición 2014)</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/domain-driven-design-domain-events-and-bc-integration-webcast-at-atrapaloeng-spanish/">Domain-Driven Design: Domain Events and BC Integration Webcast at @AtrapaloEng (Spanish)</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/domain-driven-design-bounded-context-integration-spanish/">Domain-Driven Design: Bounded Context Integration (Spanish)</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/mysql-5-6-developer-certification-beta-exam-review/">MySQL 5.6 Developer Certification Beta Exam Review</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://carlosbuenosvinos.com/" >
    &copy; 2019 Carlos Buenosvinos
  </a>
    <div>










</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
